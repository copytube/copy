<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Copytube - 카테고리 선택</title>

  <!-- CSP (보안 강화) -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    connect-src 'self' https://www.googleapis.com https://firestore.googleapis.com https://securetoken.googleapis.com https://identitytoolkit.googleapis.com https://www.gstatic.com https://www.youtube.com;
    img-src 'self' data: https://i.ytimg.com;
    frame-src https://www.youtube.com;
    script-src 'self' https://www.gstatic.com 'unsafe-inline';
    style-src 'self' 'unsafe-inline';
    object-src 'none';
    base-uri 'self';
  ">

  <link rel="stylesheet" href="css/style.css"/>
  <style>
:root{
  /* 버튼/제목 공통 폭: 필요시 숫자만 바꿔도 두 줄이 같이 움직임 */
  --cta-width: 148px;
}

/* 선택 화면 */
.intro{
  min-height:100vh; display:flex; align-items:center; justify-content:center; text-align:center;
  padding:96px 24px 24px; background:var(--bg-2); border-bottom:1px solid var(--border);
}
.lead{ font-size:20px; color:#e6e6e6; margin:0 0 6px; }
.sublead{ font-size:14px; color:#9aa0a6; margin:0 0 12px; }

/* =========================
   상단 CTA 줄 (버튼 + 연속재생)
   ========================= */
.cta-row{
  display:grid;
  grid-template-columns: 1fr var(--cta-width) auto 1fr; /* 왼여백 | 버튼 | 체크박스 | 오른여백 */
  align-items:center; column-gap:10px;
  margin:4px 0;
}
.btn-primary{
  grid-column: 2;
  padding:8px 14px; border:0; border-radius:8px; background:#4ea1ff;
  color:#fff; font-weight:800; cursor:pointer; font-size:18px;
  width:var(--cta-width); text-align:center;
}
.inline-check{
  display:inline-flex; align-items:center; gap:8px;
  font-size:13px; color:#ddd; user-select:none;
  line-height:1;                     /* 높이 오차 제거 */
}
.inline-check input{
  width:16px; height:16px;
  margin:0; accent-color:#4ea1ff;
  appearance:auto; vertical-align:middle;
}
.cta-row .inline-check:not(.ghost){ grid-column: 3; justify-self:flex-start; }
.cta-row .inline-check.ghost{ display:none; } /* 유령 라벨 무력화(HTML 안 건드려도 됨) */

/* =========================
   카테고리 헤더 줄 (검은 버튼형 제목 + 전체선택)
   ========================= */
.cat-head{
  display:grid;
  grid-template-columns: 1fr var(--cta-width) auto 1fr; /* 상단과 동일한 3열 + 여백 */
  align-items:center; column-gap:0;
  margin:0;
}
.cat-title{
  grid-column: 2;
  /* h3를 "검은 버튼"처럼 */
  display:inline-block;
  width:var(--cta-width);
  margin:0;
  padding:8px 14px;
  background:#0f0f0f; border:none; border-radius:8px;
  color:#fff; font-weight:800; font-size:20px; text-align:center;
  pointer-events:none; user-select:none; /* 비활성 느낌 */
}
.cat-right{
  grid-column: 3;
}
.cat-right .inline-check{ /* 동일한 체크 라벨 스타일 재사용 */
  display:inline-flex; align-items:center; gap:8px;
  font-size:13px; color:#ddd; line-height:1;
}
.group:first-of-type{ margin-top:0; }
/* =========================
   그룹(대분류 + 세부)
   ========================= */
.group{
  border:1px solid var(--border); border-radius:12px; background:var(--bg-3);
  padding:8px; margin:2px 0;
  text-align:left; max-width:900px; margin-left:auto; margin-right:auto;
}
.group legend{
  display:flex; align-items:center; gap:8px;
  padding:0 4px; font-weight:800; font-size:15px; color:#eee;
  margin-bottom:0;           /* (기억값) */
  line-height:1.05;
}
.group .group-toggle{
  display:inline-flex; align-items:center; gap:8px;
  padding:6px 8px; border-radius:8px;
  background:#101010; border:1px solid #2a2a2a; color:#e5e7eb; cursor:pointer; font-weight:800;
}
.group .group-toggle input{ accent-color:#4ea1ff; }
.child-grid{
  margin-top:0;              /* (기억값) */
  display:grid; grid-template-columns:repeat(2, minmax(0,1fr)); gap:4px;
}
@media (min-width:900px){
  .child-grid{ grid-template-columns:repeat(4, minmax(0,1fr)); }
}
.child-grid label{
  background:#0f0f0f; border:1px solid #2a2a2a; border-radius:8px;
  padding:6px 8px; font-size:14px; line-height:1.2;
  display:flex; gap:6px; align-items:center; justify-content:flex-start;
}

  </style>
</head>
<body>
  <header id="topbar">
    <div class="brand">
      <a id="brandHome" href="#" aria-label="CopyTube 홈으로">
        <img class="brand-logo" src="image/copytube_logo_side.png" alt="CopyTube"/>
      </a>
    </div>

    <div class="right" style="position:relative;">
      <a id="signupLink" class="link" href="signup.html">Sign up</a>
      <a id="signinLink" class="link" href="signin.html">Sign in</a>
      <span id="welcome" class="welcome"></span>
      <button id="menuBtn" class="icon" aria-label="menu">三</button>

      <div id="dropdownMenu" class="dropdown hidden" role="menu" aria-hidden="true">
        <button id="btnAbout" type="button">CopyTube는…</button>
        <button id="btnMyUploads" type="button">내영상관리</button>
        <button id="btnSignOut" type="button">Sign out</button>
        <button id="btnGoUpload" class="menu-strong" type="button">추천영상등록</button>
      </div>
    </div>
  </header>

  <section class="intro">
    <div style="width:100%; max-width:980px; margin:0 auto;">
      <p class="lead">영상보기를 눌러 선택된 카테고리의 영상을 시청하세요.</p>
      <p class="sublead">첫 시청 시 화면 상단 <strong>음소거를 해제</strong>해 주세요. (모바일: 첫 스와이프/탭, PC: 스크롤/키 입력/클릭)</p>

      <!-- 버튼 중앙 + 오른쪽에 연속재생 -->
      <div class="cta-row">
        <label class="inline-check ghost" aria-hidden="true">
          <input type="checkbox" disabled/> 연속재생
        </label>

        <button id="btnWatch" class="btn-primary">▶ 영상보기</button>

        <label class="inline-check" id="autoNextWrap" title="영상 종료 시 자동으로 다음 영상으로 이동">
          <input type="checkbox" id="cbAutoNext"/> 연속재생
        </label>
      </div>

      <!-- 카테고리 헤드: 중앙 제목 + 오른쪽 전체선택 체크박스 -->
      <div class="cat-head">
        <h3 class="cat-title">카테고리</h3>
        <div class="cat-right">
          <label class="inline-check" title="모든 카테고리 선택/해제">
            <input type="checkbox" id="cbToggleAll"/> 전체선택
          </label>
        </div>
      </div>

      <div id="cats"><!-- JS로 그룹 렌더링 --></div>
    </div>
  </section>

  <script type="module" src="js/firebase-init.js"></script>
  <script type="module" src="js/auth.js"></script>
  <script type="module" src="js/index.js?v=20250821-layout2"></script>
</body>
</html>

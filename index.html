<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>copytube</title>
  <style>
    body { margin:0; font-family: system-ui, Arial, sans-serif; }
    header { display:flex; justify-content:space-between; align-items:center; padding:12px 16px; border-bottom:1px solid #eee; }
    nav a, button.link { margin-left:12px; text-decoration:none; color:#0366d6; background:none; border:none; cursor:pointer; font-size:14px; }
    main { padding:24px; }
    .right { display:flex; align-items:center; }
    .hidden { display:none !important; }
  </style>
</head>
<body>
  <header>
    <div><strong>copytube</strong></div>
    <div class="right">
      <a id="signupLink" href="signup.html">Sign up</a>
      <a id="signinLink" href="signin.html">Sign in</a>
      <span id="welcome" class="hidden" style="margin-right:10px;"></span>
      <button id="signoutBtn" class="link hidden">Sign out</button>
    </div>
  </header>
  <main>
    <h1>Hello world</h1>
    <p>로그인 없이도 이 페이지는 볼 수 있습니다.</p>
  </main>

  <!-- Firebase SDK 초기화 및 인증 로직 -->
  <script type="module" src="js/firebase-init.js"></script>
  <script type="module" src="js/auth.js"></script>
  <script type="module">
    import { auth, onAuthStateChanged, signOut } from './js/auth.js';

    const signupLink = document.getElementById('signupLink');
    const signinLink = document.getElementById('signinLink');
    const welcome = document.getElementById('welcome');
    const signoutBtn = document.getElementById('signoutBtn');

    onAuthStateChanged(auth, (user) => {
      const loggedIn = !!user;
      signupLink.classList.toggle('hidden', loggedIn);
      signinLink.classList.toggle('hidden', loggedIn);
      signoutBtn.classList.toggle('hidden', !loggedIn);

      if (loggedIn) {
        welcome.classList.remove('hidden');
        welcome.textContent = `안녕하세요, ${user.displayName || '회원'}님`;
      } else {
        welcome.classList.add('hidden');
        welcome.textContent = '';
      }
    });

    signoutBtn.addEventListener('click', async () => {
      await signOut(auth);
    });
  </script>
</body>
</html>
